!function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=0)}([function(e,t,i){i(2),e.exports=i(3)},function(e,t,i){var s;s=function(){var e=JSON.parse('{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","¢":"cent","£":"pound","¤":"currency","¥":"yen","©":"(c)","ª":"a","®":"(r)","º":"o","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","þ":"th","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"DJ","đ":"dj","Ē":"E","ē":"e","Ė":"E","ė":"e","Ę":"e","ę":"e","Ě":"E","ě":"e","Ğ":"G","ğ":"g","Ģ":"G","ģ":"g","Ĩ":"I","ĩ":"i","Ī":"i","ī":"i","Į":"I","į":"i","İ":"I","ı":"i","Ķ":"k","ķ":"k","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ũ":"U","ũ":"u","Ū":"u","ū":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","ǈ":"LJ","ǉ":"lj","ǋ":"NJ","ǌ":"nj","Ș":"S","ș":"s","Ț":"T","ț":"t","˚":"o","Ά":"A","Έ":"E","Ή":"H","Ί":"I","Ό":"O","Ύ":"Y","Ώ":"W","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ϊ":"I","Ϋ":"Y","ά":"a","έ":"e","ή":"h","ί":"i","ΰ":"y","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","ς":"s","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ϊ":"i","ϋ":"y","ό":"o","ύ":"y","ώ":"w","Ё":"Yo","Ђ":"DJ","Є":"Ye","І":"I","Ї":"Yi","Ј":"J","Љ":"LJ","Њ":"NJ","Ћ":"C","Џ":"DZ","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"U","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"u","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","ё":"yo","ђ":"dj","є":"ye","і":"i","ї":"yi","ј":"j","љ":"lj","њ":"nj","ћ":"c","џ":"dz","Ґ":"G","ґ":"g","฿":"baht","ა":"a","ბ":"b","გ":"g","დ":"d","ე":"e","ვ":"v","ზ":"z","თ":"t","ი":"i","კ":"k","ლ":"l","მ":"m","ნ":"n","ო":"o","პ":"p","ჟ":"zh","რ":"r","ს":"s","ტ":"t","უ":"u","ფ":"f","ქ":"k","ღ":"gh","ყ":"q","შ":"sh","ჩ":"ch","ც":"ts","ძ":"dz","წ":"ts","ჭ":"ch","ხ":"kh","ჯ":"j","ჰ":"h","ẞ":"SS","Ạ":"A","ạ":"a","Ả":"A","ả":"a","Ấ":"A","ấ":"a","Ầ":"A","ầ":"a","Ẩ":"A","ẩ":"a","Ẫ":"A","ẫ":"a","Ậ":"A","ậ":"a","Ắ":"A","ắ":"a","Ằ":"A","ằ":"a","Ẳ":"A","ẳ":"a","Ẵ":"A","ẵ":"a","Ặ":"A","ặ":"a","Ẹ":"E","ẹ":"e","Ẻ":"E","ẻ":"e","Ẽ":"E","ẽ":"e","Ế":"E","ế":"e","Ề":"E","ề":"e","Ể":"E","ể":"e","Ễ":"E","ễ":"e","Ệ":"E","ệ":"e","Ỉ":"I","ỉ":"i","Ị":"I","ị":"i","Ọ":"O","ọ":"o","Ỏ":"O","ỏ":"o","Ố":"O","ố":"o","Ồ":"O","ồ":"o","Ổ":"O","ổ":"o","Ỗ":"O","ỗ":"o","Ộ":"O","ộ":"o","Ớ":"O","ớ":"o","Ờ":"O","ờ":"o","Ở":"O","ở":"o","Ỡ":"O","ỡ":"o","Ợ":"O","ợ":"o","Ụ":"U","ụ":"u","Ủ":"U","ủ":"u","Ứ":"U","ứ":"u","Ừ":"U","ừ":"u","Ử":"U","ử":"u","Ữ":"U","ữ":"u","Ự":"U","ự":"u","Ỳ":"Y","ỳ":"y","Ỵ":"Y","ỵ":"y","Ỷ":"Y","ỷ":"y","Ỹ":"Y","ỹ":"y","‘":"\'","’":"\'","“":"\\"","”":"\\"","†":"+","•":"*","…":"...","₠":"ecu","₢":"cruzeiro","₣":"french franc","₤":"lira","₥":"mill","₦":"naira","₧":"peseta","₨":"rupee","₩":"won","₪":"new shequel","₫":"dong","€":"euro","₭":"kip","₮":"tugrik","₯":"drachma","₰":"penny","₱":"peso","₲":"guarani","₳":"austral","₴":"hryvnia","₵":"cedi","₹":"indian rupee","₽":"russian ruble","₿":"bitcoin","℠":"sm","™":"tm","∂":"d","∆":"delta","∑":"sum","∞":"infinity","♥":"love","元":"yuan","円":"yen","﷼":"rial"}');function t(t,i){if("string"!=typeof t)throw new Error("slugify: string argument expected");i="string"==typeof i?{replacement:i}:i||{};var s=t.split("").reduce(function(t,s){return t+(e[s]||s).replace(i.remove||/[^\w\s$*_+~.()'"!\-:@]/g,"")},"").trim().replace(/[-\s]+/g,i.replacement||"-");return i.lower?s.toLowerCase():s}return t.extend=function(t){for(var i in t)e[i]=t[i]},t},e.exports=s(),e.exports.default=s()},function(e,t,i){"use strict";i.r(t);var s=wp.media.View.extend({tagName:"li",className:"attachment",template:wp.template("shutterpress-attachment"),events:{click:"toggleSelectionHandler",keydown:"toggleSelectionHandler","click .check":"checkClickHandler","click .download":"downloadClickHandler"},buttons:{check:!0},initialize:function(){var e=this.options.selection;_.defaults(this.options,{rerenderOnModelChange:!0});this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"add",this.select),this.listenTo(this.model,"remove",this.deselect),e&&(e.on("reset",this.updateSelect,this),this.listenTo(this.model,"selection:single selection:unsingle",this.details),this.details(this.model,this.controller.state().get("selection")))},dispose:function(){var e=this.options.selection;return e&&e.off(null,null,this),wp.media.View.prototype.dispose.apply(this,arguments),this},render:function(){var e=_.defaults(this.model.toJSON(),{orientation:"landscape",type:"image",subtype:"",width:"",height:"",description:""},this.options);return e.buttons=this.buttons,"image"===e.type&&(e.size=this.imageSize()),this.views.detach(),this.$el.html(this.template(e)),this.updateSelect(),this.views.render(),this},toggleSelectionHandler:function(e){var t;if("INPUT"!==e.target.nodeName&&"BUTTON"!==e.target.nodeName)if(37!==e.keyCode&&38!==e.keyCode&&39!==e.keyCode&&40!==e.keyCode){if("keydown"!==e.type||13===e.keyCode||32===e.keyCode){if(e.preventDefault(),this.controller.isModeActive("grid")){if(this.controller.isModeActive("edit"))return void this.controller.trigger("edit:attachment",this.model,e.currentTarget);this.controller.isModeActive("select")&&(t="toggle")}e.shiftKey?t="between":(e.ctrlKey||e.metaKey)&&(t="toggle"),this.toggleSelection({method:t}),this.controller.trigger("selection:toggle")}}else this.controller.trigger("attachment:keydown:arrow",e)},toggleSelection:function(e){var t,i,s,r,n=this.collection,o=this.options.selection,l=this.model,a=e&&e.method;if(o){if(t=o.single(),"between"===(a=_.isUndefined(a)?o.multiple:a)&&t&&o.multiple){if(t===l)return;return i=(s=n.indexOf(t))<(r=n.indexOf(this.model))?n.models.slice(s,r+1):n.models.slice(r,s+1),o.add(i),void o.single(l)}if("toggle"===a)return o[this.selected()?"remove":"add"](l),void o.single(l);if("add"===a)return o.add(l),void o.single(l);a||(a="add"),"add"!==a&&(a="reset"),this.selected()?o[t===l?"remove":"single"](l):(o[a](l),o.single(l))}},updateSelect:function(){this[this.selected()?"select":"deselect"]()},selected:function(){var e=this.options.selection;if(e)return!!e.get(this.model.cid)},select:function(e,t){var i=this.options.selection,s=this.controller;!i||t&&t!==i||this.$el.hasClass("selected")||(this.$el.addClass("selected").attr("aria-checked",!0),s.isModeActive("grid")&&s.isModeActive("select")||this.$(".check").attr("tabindex","0"))},deselect:function(e,t){var i=this.options.selection;!i||t&&t!==i||this.$el.removeClass("selected").attr("aria-checked",!1).find(".check").attr("tabindex","-1")},details:function(e,t){var i,s=this.options.selection;s===t&&(i=s.single(),this.$el.toggleClass("details",i===this.model))},imageSize:function(e){var t=this.model.get("sizes"),i=!1;return e=e||"medium",t&&(t[e]?i=t[e]:t.large?i=t.large:t.thumbnail?i=t.thumbnail:t.full&&(i=t.full),i)?_.clone(i):{url:this.model.get("url"),width:this.model.get("width"),height:this.model.get("height"),orientation:this.model.get("orientation")}},checkClickHandler:function(e){var t=this.options.selection;t&&(e.stopPropagation(),t.where({id:this.model.get("id")}).length?(t.remove(this.model),this.$el.focus()):t.add(this.model))},downloadClickHandler:function(e){this.controller.trigger("download-file",this.model,e.currentTarget)}}),r=wp.media.View.extend({tagName:"ul",className:"attachments",attributes:{tabIndex:-1},initialize:function(){this.el.id=_.uniqueId("__shutterpress-images-view-"),_.defaults(this.options,{sortable:!1,refreshSensitivity:wp.media.isTouchDevice?300:200,refreshThreshold:3,resize:!0,idealColumnWidth:$(window).width()<640?135:150}),this._viewsByCid={},this.$window=$(window),this.resizeEvent="resize.media-modal-columns",this.collection.on("add",function(e){this.views.add(this.createAttachmentView(e),{at:this.collection.indexOf(e)})},this),this.collection.on("remove",function(e){var t=this._viewsByCid[e.cid];delete this._viewsByCid[e.cid],t&&t.remove()},this),this.collection.on("reset",this.render,this),this.scroll=_.chain(this.scroll).bind(this).throttle(this.options.refreshSensitivity).value(),this.options.scrollElement=this.options.scrollElement||this.el,$(this.options.scrollElement).on("scroll",this.scroll),_.bindAll(this,"setColumns"),this.options.resize&&(this.on("ready",this.bindEvents),this.controller.on("open",this.setColumns),_.defer(this.setColumns,this))},createAttachmentView:function(e){var t=new s({model:e,collection:this.collection,selection:this.options.selection,controller:this.controller});return this._viewsByCid[e.cid]=t},bindEvents:function(){this.$window.off(this.resizeEvent).on(this.resizeEvent,_.debounce(this.setColumns,50))},prepare:function(){this.collection.length?this.views.set(this.collection.map(this.createAttachmentView,this)):(this.views.unset(),this.collection.more())},scroll:function(){var e,t=this,i=this.options.scrollElement,s=i.scrollTop;i===document&&(i=document.body,s=$(document).scrollTop()),$(i).is(":visible")&&this.collection.hasMore()&&(e=this.views.parent.toolbar,i.scrollHeight-(s+i.clientHeight)<i.clientHeight/3&&e.get("spinner").show(),i.scrollHeight<s+i.clientHeight*this.options.refreshThreshold&&this.collection.more().done(function(){t.scroll(),e.get("spinner").hide()}))},setColumns:function(){var e=this.columns,t=this.$el.width();t&&(this.columns=Math.min(Math.round(t/this.options.idealColumnWidth),12)||1,e&&e===this.columns||this.$el.closest(".media-frame-content").attr("data-columns",this.columns))},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}}),n=wp.media.View.extend({tagName:"div",className:"media-toolbar",initialize:function(){var e=this.controller.state(),t=this.selection=e.get("shutterpress-selection"),i=this.library=e.get("shutterpress-images");this._views={},this.primary=new wp.media.view.PriorityList,this.secondary=new wp.media.view.PriorityList,this.primary.$el.addClass("media-toolbar-primary search-form"),this.secondary.$el.addClass("media-toolbar-secondary"),this.views.set([this.secondary,this.primary]),this.options.items&&this.set(this.options.items,{silent:!0}),this.options.silent||this.render(),t&&t.on("add remove reset",this.refresh,this),i&&i.on("add remove reset",this.refresh,this)},dispose:function(){return this.selection&&this.selection.off(null,null,this),this.library&&this.library.off(null,null,this),wp.media.View.prototype.dispose.apply(this,arguments)},ready:function(){this.refresh()},set:function(e,t,i){return i=i||{},_.isObject(e)?_.each(e,function(e,t){this.set(t,e,{silent:!0})},this):(t instanceof Backbone.View||(t.classes=["media-button-"+e].concat(t.classes||[]),t=new wp.media.view.Button(t).render()),t.controller=t.controller||this.controller,this._views[e]=t,this[t.options.priority<0?"secondary":"primary"].set(e,t,i)),i.silent||this.refresh(),this},get:function(e){return this._views[e]},unset:function(e,t){return delete this._views[e],this.primary.unset(e,t),this.secondary.unset(e,t),t&&t.silent||this.refresh(),this},refresh:function(){var e=this.controller.state(),t=e.get("shutterpress-images"),i=e.get("selection");_.each(this._views,function(e){if(e.model&&e.options&&e.options.requires){var s=e.options.requires,r=!1;i&&i.models&&(r=_.some(i.models,function(e){return!0===e.get("uploading")})),s.selection&&i&&!i.length?r=!0:s.library&&t&&!t.length&&(r=!0),e.model.set("disabled",r)}})}}),o=wp.media.View.extend({tagName:"input",className:"search",id:"shutterpress-search-input",attributes:{type:"search",placeholder:wp.media.view.l10n.shutterpress.search},events:{input:"search",keyup:"search"},render:function(){return this.el.value=this.model.escape("search"),this},search:_.debounce(function(e){e.target.value?this.model.set("search",e.target.value):this.model.unset("search")},300)}),l=s.extend({tagName:"div",className:"attachment-details",template:wp.template("shutterpress-attachment-details"),attributes:function(){return{tabIndex:0,"data-id":this.model.get("id")}},initialize:function(){this.options=_.defaults(this.options,{rerenderOnModelChange:!1}),this.on("ready",this.initialFocus),s.prototype.initialize.apply(this,arguments)},initialFocus:function(){wp.media.isTouchDevice||this.$('input[type="text"]').eq(0).focus()}}),a=wp.media.View.extend({tagName:"div",className:"media-sidebar shutterpress-sidebar",initialize:function(){this._views={},this.set(_.extend({},this._views,this.options.views),{silent:!0}),delete this.options.views,this.options.silent||this.render()},set:function(e,t,i){var s,r,n;return i=i||{},_.isObject(e)?(_.each(e,function(e,t){this.set(t,e)},this),this):(t instanceof Backbone.View||(t=this.toView(t,e,i)),t.controller=t.controller||this.controller,this.unset(e),s=t.options.priority||10,r=this.views.get()||[],_.find(r,function(e,t){if(e.options.priority>s)return n=t,!0}),this._views[e]=t,this.views.add(t,{at:_.isNumber(n)?n:r.length||0}),this)},get:function(e){return this._views[e]},unset:function(e){var t=this.get(e);return t&&t.remove(),delete this._views[e],this},toView:function(e){return new wp.media.View(e)}}),h=wp.media.View.extend({tagName:"div",className:"shutterpress-empty",template:wp.template("shutterpress-empty"),events:{"click .retry":"retry"},defaults:{message:"",link:!1,retry:!0},initialize:function(){this.model=new Backbone.Model(this.defaults),_.each(this.defaults,function(e,t){var i=this.options[t];_.isUndefined(i)||(this.model.set(t,i),delete this.options[t])},this),this.listenTo(this.model,"change",this.render)},prepare:function(){return this.model.toJSON()},retry:function(){this.options.browser.updateContent()},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}}),d=wp.media.View.extend({className:"checkbox-shutterpress-filters",keys:[],checked:[],initialize:function(){this.createFilters(),this.createChecked(),_.extend(this.filters,this.options.filters);var e=$("<span></span>",{text:this.label,class:"group-label"});this.$el.html(_.chain(this.filters).map(function(e,t){var i=$("<input />",{type:"checkbox",value:t,id:e.id}),s=this;i.on("change",function(e){s.checkboxChange($(this),e)});var r=$("<label />",{for:e.id,text:e.text});return{el:$("<span>",{class:"checkbox-component"}).append(i).append(r)[0],priority:e.priority||50}},this).sortBy("priority").pluck("el").value()),this.$el.prepend(e),this.$el.wrap('<div class="'+this.className+'"></div>'),this.controller.on("update-filters",_.bind(this.updateFilters,this))},createFilters:function(){this.filters={}},createChecked:function(){this.checked=[]},updateFilters:function(){this.model.set(this.name,this.getValue())},getValue:function(){return this.checked.length?!this.multiple&&this.checked.length>1?this.default:this.multiple?this.checked:this.checked[0]:null},checkboxChange:function(e){var t=e.val();e.is(":checked")?this.checked.push(t):this.checked=this.checked.filter(function(e){return t!==e})}}),c=d.extend({className:"advanced-filters gender-filter",id:"shutterpress-gender-filter",createFilters:function(){var e={};e.female={text:wp.media.view.l10n.shutterpress.filters.gender.female,props:{people_gender:"female"},priority:20,id:"shutterpress-gender-female"},e.male={text:wp.media.view.l10n.shutterpress.filters.gender.male,props:{people_gender:"male"},priority:30,id:"shutterpress-gender-male"},this.filters=e,this.label=wp.media.view.l10n.shutterpress.filters.gender.label,this.name="people_gender",this.default="both",this.multiple=!1}}),u=Backbone.Model.extend({sync:function(e,t,i){return _.isUndefined(this.id)?$.Deferred().rejectWith(this).promise():"read"===e?((i=i||{}).context=this,i.data=_.extend(i.data||{},{action:"get-shutterpress-image",id:this.id}),wp.media.ajax(i)):"update"===e?this.get("nonces")&&this.get("nonces").update?((i=i||{}).context=this,i.data=_.extend(i.data||{},{action:"save-attachment",id:this.id,nonce:this.get("nonces").update,post_id:wp.media.model.settings.post.id}),t.hasChanged()&&(i.data.changes={},_.each(t.changed,function(e,t){i.data.changes[t]=this.get(t)},this)),wp.media.ajax(i)):$.Deferred().rejectWith(this).promise():Backbone.Model.prototype.sync.apply(this,arguments)},progress:function(){this.$bar&&this.$bar.length&&this.$bar.width(this.model.get("percent")+"%")}},{create:function(e){return u.all.push(e)},get:_.memoize(function(e,t){return u.all.push(t||{id:e})})}),p=u,f=wp.media.View.extend({tagName:"div",className:"shutterpress-downloader",template:wp.template("shutterpress-downloader"),file:null,initialize:function(){return this.options=_.defaults(this.options,{state:!1}),this.on("upload-completed",function(e){var t=this;_.each(["file","loaded","size","percent"],function(e){t.file.attachment.unset(e)}),this.file.attachment.set(_.extend(e,{uploading:!1})),wp.media.model.Attachment.get(e.id,this.file.attachment),ShutterpressQueue.all(function(e){return!e.get("uploading")})&&ShutterpressQueue.reset()}),this.controller.on("download-file",this.downloadTrigger,this),this},events:{"click .download-shutterpress-image":"download"},prepare:function(){return{download:wp.media.view.l10n.shutterpress.download}},download:function(){this.addFileToQueue()},downloadTrigger:function(e,t){this.model===e&&this.addFileToQueue()},openMediaTab:function(){var e=this.options.state;"shutterpress"===this.controller.content.mode()&&this.controller.content.mode("browse"),e.get("selection").add(this.file.attachment),this.controller.trigger("library:selection:add")},addFileToQueue:function(){var e=_.extend({item:this.model,uploading:!0,date:new Date,menuOrder:0,progress:0,filename:"",uploadedTo:wp.media.model.settings.post.id});this.file={shutterpressId:this.model.id,attachment:new wp.media.model.Attachment(e)},ShutterpressQueue.add(this.file.attachment),this.openMediaTab(),this.getFile()},getFile:function(){var e=e||{};return e.context=this,e.data=_.extend(e.data||{},{action:"cache-shutterpress",media_id:this.file.shutterpressId,post_id:wp.media.model.settings.post.id}),wp.media.ajax(e).done(function(e){this.trigger("upload-completed",e)}).fail(function(){this.file.attachment.set("percent",30),this.downloadFile()})},downloadFile:function(){var e=e||{};e.context=this,e.data=_.extend(e.data||{},{action:"download-shutterpress",media_id:this.file.shutterpressId,search:this.options.search,post_id:wp.media.model.settings.post.id,description:this.model.get("description")});var t=this,i=setInterval(function(){t.incrementPercent()},1e3);wp.media.ajax(e).done(function(e){clearInterval(i),this.trigger("upload-completed",e)}).fail(function(e){clearInterval(i),this.error(e.message,null,this.file)})},incrementPercent:function(){this.file.attachment.get("percent")<99&&this.file.attachment.set({percent:this.file.attachment.get("percent")+4})},error:function(e,t,i){i.attachment&&i.attachment.destroy(),wp.Uploader.errors.unshift({message:e||pluploadL10n.default_error,data:t,file:i})}}),m=wp.media.View.extend({tagName:"a",className:"shutterpress-advanced",id:"shutterpress-advanced-link",defaults:{text:"",disabled:!1},initialize:function(){this.model=new Backbone.Model(this.defaults),_.each(this.defaults,function(e,t){var i=this.options[t];_.isUndefined(i)||(this.model.set(t,i),delete this.options[t])},this),this.listenTo(this.model,"change",this.render)},render:function(){var e=[this.className],t=this.model.toJSON();return e=_.uniq(e.concat(this.options.classes)),this.el.className=e.join(" "),this.$el.attr("disabled",t.disabled),this.$el.text(this.model.get("text")),this},events:{click:"toggleAdvanced"},toggleAdvanced:function(){$("#shutterpress-advanced-filters").toggleClass("visible")}}),g=wp.media.View.extend({tagName:"div",className:"shutterpress-advanced-filters",id:"shutterpress-advanced-filters",attributes:{},initialize:function(){this.controller.state();this._views={},this.filters=new wp.media.view.PriorityList,this.actions=new wp.media.view.PriorityList,this.actions.$el.addClass("shutterpress-filters-actions"),this.filters.$el.addClass("shutterpress-filters-sub-container"),this.views.set([this.filters,this.actions]),this.options.items&&this.set(this.options.items,{silent:!0}),this.options.silent||this.render()},ready:function(){this.refresh()},set:function(e,t,i){return i=i||{},_.isObject(e)?_.each(e,function(e,t){this.set(t,e,{silent:!0})},this):(t instanceof Backbone.View||(t.classes=["media-button-"+e].concat(t.classes||[]),t=new wp.media.view.Button(t).render()),t.controller=t.controller||this.controller,this._views[e]=t,this[t.options.priority<0?"filters":"actions"].set(e,t,i)),i.silent||this.refresh(),this},get:function(e){return this._views[e]},unset:function(e,t){return delete this._views[e],this.link.unset(e,t),this.filters.unset(e,t),t&&t.silent||this.refresh(),this},refresh:function(){var e=this.controller.state(),t=e.get("shutterpress-images"),i=e.get("selection");_.each(this._views,function(e){if(e.model&&e.options&&e.options.requires){var s=e.options.requires,r=!1;i&&i.models&&(r=_.some(i.models,function(e){return!0===e.get("uploading")})),s.selection&&i&&!i.length?r=!0:s.library&&t&&!t.length&&(r=!0),e.model.set("disabled",r)}})}}),v=wp.media.View.extend({tagName:"div",className:"shutterpress-advanced",id:"shutterpress-advanced-area",attributes:{},initialize:function(){this.controller.state();this._views={},this.link=new wp.media.view.PriorityList,this.filters=new wp.media.view.PriorityList,this.link.$el.addClass("shutterpress-filters-trigger"),this.filters.$el.addClass("shutterpress-filters-container"),this.views.set([this.link,this.filters]),this.options.items&&this.set(this.options.items,{silent:!0}),this.options.silent||this.render()},ready:function(){this.refresh()},set:function(e,t,i){return i=i||{},_.isObject(e)?_.each(e,function(e,t){this.set(t,e,{silent:!0})},this):(t instanceof Backbone.View||(t.classes=["media-button-"+e].concat(t.classes||[]),t=new wp.media.view.Button(t).render()),t.controller=t.controller||this.controller,this._views[e]=t,this[t.options.priority<0?"link":"filters"].set(e,t,i)),i.silent||this.refresh(),this},get:function(e){return this._views[e]},unset:function(e,t){return delete this._views[e],this.link.unset(e,t),this.filters.unset(e,t),t&&t.silent||this.refresh(),this},refresh:function(){var e=this.controller.state(),t=e.get("shutterpress-images"),i=e.get("selection");_.each(this._views,function(e){if(e.model&&e.options&&e.options.requires){var s=e.options.requires,r=!1;i&&i.models&&(r=_.some(i.models,function(e){return!0===e.get("uploading")})),s.selection&&i&&!i.length?r=!0:s.library&&t&&!t.length&&(r=!0),e.model.set("disabled",r)}})}}),w=wp.media.View.extend({tagName:"a",className:"shutterpress-start-filter button-primary button-large",defaults:{text:"",disabled:!1},initialize:function(){this.model=new Backbone.Model(this.defaults),_.each(this.defaults,function(e,t){var i=this.options[t];_.isUndefined(i)||(this.model.set(t,i),delete this.options[t])},this),this.listenTo(this.model,"change",this.render)},render:function(){var e=[this.className],t=this.model.toJSON();return e=_.uniq(e.concat(this.options.classes)),this.el.className=e.join(" "),this.$el.attr("disabled",t.disabled),this.$el.text(this.model.get("text")),this},events:{click:"triggerFilter"},triggerFilter:function(){this.controller.trigger("update-filters",this.model,event.currentTarget)}}),y=d.extend({className:"advanced-filters orientation-filter",id:"shutterpress-gender-filter",createFilters:function(){var e={};e.horizontal={text:wp.media.view.l10n.shutterpress.filters.orientation.horizontal,props:{orientation:"horizontal"},priority:20,id:"shutterpress-orientation-horizontal"},e.vertical={text:wp.media.view.l10n.shutterpress.filters.orientation.vertical,props:{orientation:"vertical"},priority:30,id:"shutterpress-orientation-vertical"},this.filters=e,this.label=wp.media.view.l10n.shutterpress.filters.orientation.label,this.name="orientation",this.default=null,this.multiple=!1}}),b=d.extend({className:"advanced-filters image-type-filter",id:"shutterpress-image-type-filter",createFilters:function(){var e={};e.photo={text:wp.media.view.l10n.shutterpress.filters.image_type.photo,props:{image_type:"photo"},priority:20,id:"shutterpress-image-type-photo"},e.vector={text:wp.media.view.l10n.shutterpress.filters.image_type.vector,props:{image_type:"vector"},priority:30,id:"shutterpress-image-type-vector"},e.illustration={text:wp.media.view.l10n.shutterpress.filters.image_type.illustration,props:{image_type:"illustration"},priority:30,id:"shutterpress-image-photo-illustration"},this.filters=e,this.label=wp.media.view.l10n.shutterpress.filters.image_type.label,this.name="image_type",this.default=null,this.multiple=!0}}),x=wp.media.View.extend({tagName:"div",className:"shutterpress-select-filters",keys:[],initialize:function(){this.createFilters(),_.extend(this.filters,this.options.filters);var e=$("<span></span>",{text:this.label,class:"group-label"}),t=$("<select />");t.html(_.chain(this.filters).map(function(e,t){return{el:$("<option></option>").val(t).html(e.text)[0],priority:e.priority||50}},this).sortBy("priority").pluck("el").value()),this.$el.prepend(t),this.$el.prepend(e),this.controller.on("update-filters",_.bind(this.change,this))},createFilters:function(){this.filters={}},change:function(){var e=this.filters[this.getValue()];e&&this.model.set(e.props)},getValue:function(){return this.$el.find("select").val()}});function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=[],s=!0,r=!1,n=void 0;try{for(var o,l=e[Symbol.iterator]();!(s=(o=l.next()).done)&&(i.push(o.value),!t||i.length!==t);s=!0);}catch(e){r=!0,n=e}finally{try{s||null==l.return||l.return()}finally{if(r)throw n}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var C,N=i(1),S=x.extend({className:"advanced-filters category-filter",id:"shutterpress-category-filter",createFilters:function(){var e={},t=1;e.default={text:wp.media.view.l10n.shutterpress.filters.categories.default,props:{category:null},priority:t,id:"shutterpress-category-default"};for(var i=wp.media.view.l10n.shutterpress.filters.categories.values,s=Object.entries(i),r=0;r<s.length;r++){var n=k(s[r],2),o=n[0];n[1];i.hasOwnProperty(o)&&(t++,e[o]={text:i[o],props:{category:o},priority:t,id:"shutterpress-category-"+N(o)})}this.filters=e,this.label=wp.media.view.l10n.shutterpress.filters.categories.label,this.name="category",this.default=null}}),O=wp.media.View.extend({className:"radio-shutterpress-filters",keys:[],checked:[],initialize:function(){this.createFilters(),this.createChecked(),_.extend(this.filters,this.options.filters);var e=$("<span></span>",{text:this.label,class:"group-label"});this.$el.html(_.chain(this.filters).map(function(e,t){var i=$("<input />",{type:"radio",name:e.name,value:t,id:e.id,checked:e.checked}),s=this;i.on("change",function(e){s.radioChange($(this),e)});var r=$("<label />",{for:e.id,text:e.text});return{el:$("<span>",{class:"radio-component"}).append(i).append(r)[0],priority:e.priority||50}},this).sortBy("priority").pluck("el").value()),this.$el.prepend(e),this.$el.wrap('<div class="'+this.className+'"></div>'),this.controller.on("update-filters",_.bind(this.updateFilters,this)),this.radioChange(this.$el)},createFilters:function(){this.filters={}},createChecked:function(){this.checked=[]},updateFilters:function(){this.model.set(this.getValue())},getValue:function(){if(!this.checked.length)return null;var e=this.filters[this.checked];return e?e.props:void 0},radioChange:function(e){this.checked=e.val()}}).extend({className:"advanced-filters safe-filter",id:"shutterpress-safe-filter",createFilters:function(){var e={};e.yes={text:wp.media.view.l10n.shutterpress.filters.safe.yes,props:{safe:!0},name:"safe-search-shutterpress",priority:20,id:"shutterpress-safe-yes"},e.no={text:wp.media.view.l10n.shutterpress.filters.safe.no,props:{safe:!1},priority:30,name:"safe-search-shutterpress",id:"shutterpress-safe-no"},this.filters=e,this.label=wp.media.view.l10n.shutterpress.filters.safe.label,this.name="safe"}}),A=wp.media.View.extend({className:"color-picker-shutterpress-filters",keys:[],checked:[],initialize:function(){this.createFilters(),_.extend(this.filters,this.options.filters);var e=$("<span></span>",{text:this.label,class:"group-label"});this.$el.html(_.chain(this.filters).map(function(e,t){return{el:$("<input />",{type:"text",id:e.id,class:"shutterpress-color-picker"})[0],priority:e.priority||50}},this).sortBy("priority").pluck("el").value()),this.$el.find("input").wpColorPicker(),this.$el.prepend(e),this.$el.wrap('<div class="'+this.className+'"></div>'),this.controller.on("update-filters",_.bind(this.change,this))},createFilters:function(){this.filters={}},change:function(){var e=this.getValue();return e&&""!==e?(this.model.set(this.name,e),this):(this.model.set(this.name,null),this)},getValue:function(){return this.$el.find("input").val()}}).extend({className:"advanced-filters color-filter",id:"shutterpress-color-filter",createFilters:function(){var e={};e.color={text:wp.media.view.l10n.shutterpress.filters.color.text,props:{color:null},priority:20,id:"shutterpress-color-picker"},this.filters=e,this.label=wp.media.view.l10n.shutterpress.filters.color.text,this.name="color"}}),z=wp.media.View.extend({tagName:"span",className:"shutterpress-close-filter",defaults:{text:"",disabled:!1},initialize:function(){this.model=new Backbone.Model(this.defaults),_.each(this.defaults,function(e,t){var i=this.options[t];_.isUndefined(i)||(this.model.set(t,i),delete this.options[t])},this),this.listenTo(this.model,"change",this.render)},render:function(){var e=[this.className],t=this.model.toJSON();return e=_.uniq(e.concat(this.options.classes)),this.el.className=e.join(" "),this.$el.attr("disabled",t.disabled),this.$el.text(this.model.get("text")),this},events:{click:"closeAdvanced"},closeAdvanced:function(){$("#shutterpress-advanced-filters").toggleClass("visible")}}),F=wp.media.View.extend({tagName:"div",className:"shutterpress-browser attachments-browser",initialize:function(){_.defaults(this.options,{search:!0}),this.createToolbar(),this.createSidebar(),this.createStatus(),this.createImages(),this.updateContent(),this.collection.on("add remove reset",this.updateContent,this)},dispose:function(){return this.options.selection.off(null,null,this),wp.media.View.prototype.dispose.apply(this,arguments),this},createImages:function(){this.images=new r({controller:this.controller,collection:this.collection,selection:this.options.selection,scrollElement:this.options.scrollElement,idealColumnWidth:this.options.idealColumnWidth}),this.views.add(this.images),this.images.hide()},createSidebar:function(){var e=this.options.selection,t=this.sidebar=new a({controller:this.controller});this.views.add(t),e.on("selection:single",this.createSingle,this),e.on("selection:unsingle",this.disposeSingle,this),e.single()&&this.createSingle()},createSingle:function(){var e=this.sidebar,t=this.options.selection.single();e.set("details",new l({controller:this.controller,model:t,priority:80})),e.set("downloader",new f({controller:this.controller,model:t,state:this.model,search:this.collection.props.get("search"),priority:90})),"insert"===this.model.id&&e.$el.addClass("visible")},disposeSingle:function(){var e=this.sidebar;e.unset("details"),e.unset("downloader"),e.$el.removeClass("visible")},updateContent:function(){var e,t=this;(e=t.status).hide(),this.collection.length?(t.images.show(),e.hide(),this.stopLoading()):(this.startLoading(),this.clearErrors(),this.dfd=this.collection.more().done(function(){t.collection.length?e.hide():e.show(),t.stopLoading()}).fail(function(i){e.show(),t.displayError(i),t.stopLoading()}))},createToolbar:function(){var e;e={controller:this.controller},this.controller.isModeActive("grid")&&(e.className="media-toolbar wp-filter"),this.toolbar=new n(e),this.views.add(this.toolbar),this.advancedFilters=new v({controller:this.controller,priority:50}),this.toolbar.set("advanced-filters",this.advancedFilters),this.toolbar.set("spinner",new wp.media.view.Spinner({priority:-60})),this.addToolbarFilters()},addToolbarFilters:function(){this.toolbar.set("searchLabel",new wp.media.view.Label({value:wp.media.view.l10n.shutterpress.search,attributes:{for:"media-search-input"},priority:60}).render()),this.toolbar.set("search",new o({controller:this.controller,model:this.collection.props,priority:60}).render()),this.advancedFilters.set("advanced-link",new m({controller:this.controller,model:this.collection.props,text:wp.media.view.l10n.shutterpress.advanced,priority:-10}).render()),this.filtersContainer=new g({controller:this.controller,model:this.collection.props,priority:10}),this.advancedFilters.set("filters-container",this.filtersContainer).render();var e=new b({controller:this.controller,model:this.collection.props,priority:-100});this.filtersContainer.set("image-type-filter",e.render());var t=new S({controller:this.controller,model:this.collection.props,priority:-95});this.filtersContainer.set("category-filter",t.render());var i=new c({controller:this.controller,model:this.collection.props,priority:-90});this.filtersContainer.set("gender-filter",i.render());var s=new O({controller:this.controller,model:this.collection.props,priority:-85});this.filtersContainer.set("safe-filter",s.render());var r=new y({controller:this.controller,model:this.collection.props,priority:-80});this.filtersContainer.set("orientation-filter",r.render());var n=new A({controller:this.controller,model:this.collection.props,priority:-70});this.filtersContainer.set("color-filter",n.render()),this.filtersContainer.set("update-filter",new w({controller:this.controller,model:this.collection.props,priority:20,text:wp.media.view.l10n.shutterpress.search})),this.filtersContainer.set("close-advanced-filter",new z({controller:this.controller,model:this.collection.props,priority:10,text:" "}))},createStatus:function(){var e;e={controller:this.controller,message:wp.media.view.l10n.shutterpress.noMedia,retry:wp.media.view.l10n.shutterpress.retry,browser:this},this.controller.isModeActive("grid")&&(e.className="media-toolbar wp-filter"),this.status=new h(e),this.status.hide(),this.views.add(this.status)},displayError:function(e){this.images.hide(),this.status.model.set("message",wp.media.view.l10n.shutterpress.error),this.status.model.set("error",e.message),2===e.code&&this.status.model.set("link",{url:wp.media.view.l10n.shutterpress.url,text:wp.media.view.l10n.shutterpress.link})},clearErrors:function(){this.status.model.set("message",wp.media.view.l10n.shutterpress.noMedia),this.status.model.set("error","")},stopLoading:function(){this.toolbar.get("spinner").hide()},startLoading:function(){this.toolbar.get("spinner").show()}}),M=Backbone.Collection.extend({model:p,initialize:function(e,t){t=t||{},this.props=new Backbone.Model,this.filters=t.filters||{},this.props.on("change",_.debounce(this._changeFilteredProps,250),this),this.props.on("change:query",_.debounce(this._changeQuery,250),this),this.props.set(_.defaults(t.props||{}))},mirror:function(e){return this.mirroring&&this.mirroring===e?this:(this.unmirror(),this.mirroring=e,this.reset([],{silent:!0}),this.observe(e),this)},unmirror:function(){this.mirroring&&(this.unobserve(this.mirroring),delete this.mirroring)},_changeQuery:function(e,t){t?(this.props.on("change",_.debounce(this._requery,250),this),this._requery()):this.props.off("change",this._requery,this)},_changeFilteredProps:function(e){this.props.get("query")||_.chain(e.changed).map(function(t,i){var s=M.filters[i],r=e.get(i);if(s){if(r&&!this.filters[i])this.filters[i]=s;else{if(r||this.filters[i]!==s)return;delete this.filters[i]}return!0}},this).any().value()&&(this._source||(this._source=new M(this.models)),this.reset(this._source.filter(this.validator,this)))},_requery:function(e){var t;this.props.get("query")&&((t=this.props.toJSON()).cache=!0!==e,this.mirror(ShutterpressQuery.get(t)))},more:function(e){var t=jQuery.Deferred(),i=this.mirroring,s=this;return i&&i.more?(i.more(e).done(function(){this===s.mirroring&&t.resolveWith(this)}).fail(function(e){this===s.mirroring&&t.rejectWith(this,e)}),t.promise()):t.resolveWith(this).promise()},hasMore:function(){return!!this.mirroring&&this.mirroring.hasMore()},validateDestroyed:!1,validator:function(e){return!(!_.isUndefined(e.attributes.context)&&""!==e.attributes.context)&&(!(!this.validateDestroyed&&e.destroyed)&&_.all(this.filters,function(t){return!!t.call(this,e)},this))},validate:function(e,t){var i=this.validator(e),s=!!this.get(e.cid);return!i&&s?this.remove(e,t):i&&!s&&this.add(e,t),this},validateAll:function(e,t){return t=t||{},_.each(e.models,function(e){this.validate(e,{silent:!0})},this),t.silent||this.trigger("reset",this,t),this},observe:function(e){return this.observers=this.observers||[],this.observers.push(e),e.on("add change remove",this._validateHandler,this),e.on("reset",this._validateAllHandler,this),this.validateAll(e),this},unobserve:function(e){return e?(e.off(null,null,this),this.observers=_.without(this.observers,e)):(_.each(this.observers,function(e){e.off(null,null,this)},this),delete this.observers),this},_validateHandler:function(e,t,i){return i=t===this.mirroring?i:{silent:i&&i.silent},this.validate(e,i)},_validateAllHandler:function(e,t){return this.validateAll(e,t)}},{filters:{search:function(e){return!this.props.get("search")||_.any(["description"],function(t){var i=e.get(t);return i&&-1!==i.search(this.props.get("search"))},this)}}});window.ShutterpressQuery=M.extend({initialize:function(e,t){t=t||{},M.prototype.initialize.apply(this,arguments),this.args=t.args,this._hasMore=!0,this.created=new Date},hasMore:function(){return this._hasMore},more:function(e){var t=this;return this._more&&"pending"===this._more.state()?this._more:this.hasMore()?((e=e||{}).remove=!1,this._more=this.fetch(e).done(function(e){(_.isEmpty(e)||-1===this.args.per_page||e.length<this.args.per_page)&&(t._hasMore=!1)})):jQuery.Deferred().resolveWith(this).promise()},sync:function(e,t,i){var s;return"read"===e?((i=i||{}).context=this,i.data=_.extend(i.data||{},{action:"query-shutterpress",post_id:wp.media.model.settings.post.id}),-1!==(s=_.clone(this.args)).per_page&&(s.page=Math.round(this.length/s.per_page)+1),i.data.query=s,wp.media.ajax(i)):(ShutterPressImagesModel.prototype.sync?ShutterPressImagesModel.prototype:Backbone).sync.apply(this,arguments)}},{defaultArgs:{per_page:40},defaultProps:{},propmap:{search:"query",perPage:"per_page"},get:(C=[],function(e,t){var i,s={},r=ShutterpressQuery.defaults,n=!!e.cache||_.isUndefined(e.cache);return delete e.query,delete e.cache,_.defaults(e,r),_.each(["include","exclude"],function(t){e[t]&&!_.isArray(e[t])&&(e[t]=[e[t]])}),_.each(e,function(e,t){_.isNull(e)||(s[ShutterpressQuery.propmap[t]||t]=e)}),_.defaults(s,ShutterpressQuery.defaultArgs),n?i=_.find(C,function(e){return _.isEqual(e.args,s)}):C=[],i||(i=new ShutterpressQuery([],_.extend(t||{},{props:e,args:s})),C.push(i)),i})});var E=M,T=E.extend({initialize:function(e,t){E.prototype.initialize.apply(this,arguments),this.multiple=t&&t.multiple,this.on("add remove reset",_.bind(this.single,this,!1))},add:function(e,t){return this.multiple||this.remove(this.models),E.prototype.add.call(this,e,t)},single:function(e){var t=this._single;return e&&(this._single=e),this._single&&!this.get(this._single.cid)&&delete this._single,this._single=this._single||this.last(),this._single!==t&&(t&&(t.trigger("selection:unsingle",t,this),this.get(t.cid)||this.trigger("selection:unsingle",t,this)),this._single&&this._single.trigger("selection:single",this._single,this)),this._single}});window.getShutterPressQuery=function(e){return new E(null,{props:_.extend(_.defaults(e||{},{orderby:"date"}),{query:!0})})};wp.media.controller.Library;var V=wp.media.view.MediaFrame.Post,j=wp.media.view.MediaFrame.Select;window.ShutterpressQueue=new E([],{query:!1}),window.ShutterpressQueueErrors=new Backbone.Collection,wp.media.view.MediaFrame.Post=V.extend({browseRouter:function(e){V.prototype.browseRouter.apply(this,arguments),e.set({shutterpress:{text:wp.media.view.l10n.shutterpress.title,priority:60}})},bindHandlers:function(){V.prototype.bindHandlers.apply(this,arguments),this.on("content:create:shutterpress",this.shutterpressContent,this)},shutterpressContent:function(e){var t,i=this.state();(i.get("shutterpress-images")||(i.set("shutterpress-images",getShutterPressQuery()),i.get("library").observe(ShutterpressQueue)),i.get("shutterpress-selection"))||(t=i.get("shutterpress-images").props.toJSON(),t=_.omit(t,"orderby","query"),i.set("shutterpress-selection",new T(null,{multiple:!1,props:t})));this.$el.removeClass("hide-toolbar"),e.view=new F({collection:i.get("shutterpress-images"),selection:i.get("shutterpress-selection"),controller:this,model:i,idealColumnWidth:i.get("idealColumnWidth"),suggestedWidth:i.get("suggestedWidth"),suggestedHeight:i.get("suggestedHeight")})},getFrame:function(e){return this.states.findWhere({id:e})}}),wp.media.view.MediaFrame.Select=j.extend({browseRouter:function(e){j.prototype.browseRouter.apply(this,arguments),e.set({shutterpress:{text:wp.media.view.l10n.shutterpress.title,priority:60}})},bindHandlers:function(){j.prototype.bindHandlers.apply(this,arguments),this.on("content:create:shutterpress",this.shutterpressContent,this)},shutterpressContent:function(e){var t,i=this.state();(i.get("shutterpress-images")||(i.set("shutterpress-images",getShutterPressQuery()),i.get("library").observe(ShutterpressQueue)),i.get("shutterpress-selection"))||(t=i.get("shutterpress-images").props.toJSON(),t=_.omit(t,"orderby","query"),i.set("shutterpress-selection",new T(null,{multiple:!1,props:t})));this.$el.removeClass("hide-toolbar"),e.view=new F({collection:i.get("shutterpress-images"),selection:i.get("shutterpress-selection"),controller:this,model:i,idealColumnWidth:i.get("idealColumnWidth"),suggestedWidth:i.get("suggestedWidth"),suggestedHeight:i.get("suggestedHeight")})},getFrame:function(e){return this.states.findWhere({id:e})}})},function(e,t){}]);